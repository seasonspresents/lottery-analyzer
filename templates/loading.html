<!DOCTYPE html>
<html data-theme="cupcake">
<head>
    <meta charset="UTF-8">
    <title>{{ state_cfg.abbreviation }} Scratcher Analyzer</title>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet" type="text/css" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@700;800;900&display=swap');
        body { font-family: 'Nunito', system-ui, sans-serif; background: #FFF8F0; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .spinner { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,0.3); border-top-color: white; border-radius: 50%; animation: spin 0.7s linear infinite; vertical-align: middle; margin-right: 8px; }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center">
    <div class="text-center">
        <h1 class="text-4xl font-black mb-3" style="color: #1a1a2e;">
            <span style="color: #FF6B6B;">{{ state_cfg.abbreviation }}</span> Scratcher Analyzer
        </h1>
        <p class="text-gray-500 font-bold mb-8">No {{ state_cfg.name }} data yet â€” let's fix that.</p>
        <button id="btn" onclick="refresh()"
            class="font-extrabold text-white text-lg px-8 py-4 rounded-2xl shadow-lg cursor-pointer border-0 active:scale-95"
            style="background: linear-gradient(135deg, #58CC02 0%, #4ADE80 100%); box-shadow: 0 4px 14px rgba(88,204,2,0.4);">
            Fetch {{ state_cfg.abbreviation }} Data Now
        </button>
        <p id="status" class="mt-4 text-sm font-bold text-gray-400"></p>
    </div>
    <script>
        function refresh() {
            const btn = document.getElementById('btn');
            btn.innerHTML = '<span class="spinner"></span> Scraping {{ state_cfg.name }} lottery data...';
            btn.disabled = true;
            btn.style.opacity = '0.7';
            document.getElementById('status').textContent = '';
            fetch('/api/refresh?state={{ state }}', { method: 'POST' })
                .then(r => r.json())
                .then(data => {
                    if (data.status === 'ok') window.location.reload();
                    else {
                        document.getElementById('status').textContent = 'Error: ' + (data.error || 'Unknown');
                        btn.textContent = 'Fetch {{ state_cfg.abbreviation }} Data Now';
                        btn.disabled = false;
                        btn.style.opacity = '1';
                    }
                })
                .catch(e => {
                    document.getElementById('status').textContent = 'Error: ' + e;
                    btn.textContent = 'Fetch {{ state_cfg.abbreviation }} Data Now';
                    btn.disabled = false;
                    btn.style.opacity = '1';
                });
        }
    </script>
</body>
</html>
